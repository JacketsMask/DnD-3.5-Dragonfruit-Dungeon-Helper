/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package gui.abilityscore;

import character.CharacterAbilityScore;
import character.Player;
import character.effects.AbilityScoreEffect;
import character.effects.EffectManager;
import character.effects.EffectTarget;
import enumerations.AbilityScore;
import javax.swing.DefaultListModel;

/**
 *
 * @author Japhez
 */
public final class AbilityScoreBonusModifierDialog extends javax.swing.JDialog {

    private Player player;
    private AbilityScorePanel parent;

    /**
     * Creates new form AbilityScoreBonusModifierDialog
     */
    public AbilityScoreBonusModifierDialog(AbilityScorePanel parent, boolean modal, Player player) {
        this.parent = parent;
        this.player = player;
        initComponents();
        dialogAbilityScoreBonusDescriptions.setModel(player.getEffectManager().getDefaultListModel(EffectTarget.ABILITY_SCORE));
        updateVisibleStatistics();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel6 = new javax.swing.JPanel();
        jLabel11 = new javax.swing.JLabel();
        jLabel35 = new javax.swing.JLabel();
        jLabel44 = new javax.swing.JLabel();
        jLabel45 = new javax.swing.JLabel();
        jLabel47 = new javax.swing.JLabel();
        jLabel61 = new javax.swing.JLabel();
        dialogAbilityScoreBonusConstitution = new javax.swing.JLabel();
        jLabel65 = new javax.swing.JLabel();
        dialogAbilityScoreBonusIntelligence = new javax.swing.JLabel();
        dialogAbilityScoreBonusWisdom = new javax.swing.JLabel();
        dialogAbilityScoreBonusCharisma = new javax.swing.JLabel();
        dialogAbilityScoreBonusDexterity = new javax.swing.JLabel();
        dialogAbilityScoreBonusStrength = new javax.swing.JLabel();
        jScrollPane5 = new javax.swing.JScrollPane();
        dialogAbilityScoreBonusDescriptions = new javax.swing.JList();
        dialogAbilityScoreBonusAddModifier = new javax.swing.JButton();
        dialogAbilityScoreBonusRemoveModifier = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Bonus/Penalty ability score modifiers");
        setLocationByPlatform(true);
        setResizable(false);

        jLabel11.setText("Strength");

        jLabel35.setText("Dexterity");

        jLabel44.setText("Constitution");

        jLabel45.setText("Intelligence");

        jLabel47.setText("Wisdom");

        jLabel61.setText("Charisma");

        dialogAbilityScoreBonusConstitution.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusConstitution.setText("jLabel63");

        jLabel65.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel65.setText("Base Ability Score");

        dialogAbilityScoreBonusIntelligence.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusIntelligence.setText("jLabel63");

        dialogAbilityScoreBonusWisdom.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusWisdom.setText("jLabel63");

        dialogAbilityScoreBonusCharisma.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusCharisma.setText("jLabel63");

        dialogAbilityScoreBonusDexterity.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusDexterity.setText("jLabel63");

        dialogAbilityScoreBonusStrength.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        dialogAbilityScoreBonusStrength.setText("jLabel63");

        dialogAbilityScoreBonusDescriptions.setModel(new javax.swing.AbstractListModel() {
            String[] strings = { "stuff goes here" };
            public int getSize() { return strings.length; }
            public Object getElementAt(int i) { return strings[i]; }
        });
        jScrollPane5.setViewportView(dialogAbilityScoreBonusDescriptions);

        dialogAbilityScoreBonusAddModifier.setText("Add New Modifier");
        dialogAbilityScoreBonusAddModifier.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dialogAbilityScoreBonusAddModifierActionPerformed(evt);
            }
        });

        dialogAbilityScoreBonusRemoveModifier.setText("Remove Selected Modifier");
        dialogAbilityScoreBonusRemoveModifier.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dialogAbilityScoreBonusRemoveModifierActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel65)
                            .addGroup(jPanel6Layout.createSequentialGroup()
                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel44)
                                    .addComponent(jLabel45)
                                    .addComponent(jLabel47)
                                    .addComponent(jLabel61)
                                    .addComponent(jLabel35)
                                    .addComponent(jLabel11))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(dialogAbilityScoreBonusStrength)
                                    .addComponent(dialogAbilityScoreBonusDexterity)
                                    .addComponent(dialogAbilityScoreBonusCharisma)
                                    .addComponent(dialogAbilityScoreBonusWisdom)
                                    .addComponent(dialogAbilityScoreBonusIntelligence)
                                    .addComponent(dialogAbilityScoreBonusConstitution)))))
                    .addComponent(dialogAbilityScoreBonusAddModifier))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(dialogAbilityScoreBonusRemoveModifier)
                        .addGap(0, 137, Short.MAX_VALUE))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jScrollPane5)
                        .addContainerGap())))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane5)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel65)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel11)
                            .addComponent(dialogAbilityScoreBonusStrength))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel35)
                            .addComponent(dialogAbilityScoreBonusDexterity))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel44)
                            .addComponent(dialogAbilityScoreBonusConstitution))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel45)
                            .addComponent(dialogAbilityScoreBonusIntelligence))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel47)
                            .addComponent(dialogAbilityScoreBonusWisdom))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel61)
                            .addComponent(dialogAbilityScoreBonusCharisma))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 27, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(dialogAbilityScoreBonusAddModifier)
                    .addComponent(dialogAbilityScoreBonusRemoveModifier))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void dialogAbilityScoreBonusAddModifierActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_dialogAbilityScoreBonusAddModifierActionPerformed
    {//GEN-HEADEREND:event_dialogAbilityScoreBonusAddModifierActionPerformed
        AddAbilityScoreBonusModifierDialog child = new AddAbilityScoreBonusModifierDialog(this, true, player);
        //this.setVisible(false);
        this.setAlwaysOnTop(false);
        child.setVisible(true);
    }//GEN-LAST:event_dialogAbilityScoreBonusAddModifierActionPerformed

    private void dialogAbilityScoreBonusRemoveModifierActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_dialogAbilityScoreBonusRemoveModifierActionPerformed
    {//GEN-HEADEREND:event_dialogAbilityScoreBonusRemoveModifierActionPerformed
        //Get the effect manager
        EffectManager effectManager = player.getEffectManager();
        //Deactivate the selected effect
        AbilityScoreEffect selectedValue = (AbilityScoreEffect) dialogAbilityScoreBonusDescriptions.getSelectedValue();
        effectManager.deactivate(selectedValue);
        //Remove the selected value from the model
        DefaultListModel<AbilityScoreEffect> modifierList = (DefaultListModel) dialogAbilityScoreBonusDescriptions.getModel();
        modifierList.removeElement(selectedValue);
        updateVisibleStatistics();
        parent.updateVisibleAbilityScoreBonus();
        parent.updateVisibleAbilityScoreTotal();
        parent.updateVisibleAbilityScoreModifiers();
    }//GEN-LAST:event_dialogAbilityScoreBonusRemoveModifierActionPerformed
    public void updateVisibleStatistics() {
        CharacterAbilityScore abilityScore = player.getAbilityScore();
        this.pack();
        dialogAbilityScoreBonusStrength.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.STRENGTH));
        dialogAbilityScoreBonusConstitution.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.CONSTITUTION));
        dialogAbilityScoreBonusDexterity.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.DEXTERITY));
        dialogAbilityScoreBonusIntelligence.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.INTELLIGENCE));
        dialogAbilityScoreBonusWisdom.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.WISDOM));
        dialogAbilityScoreBonusCharisma.setText("" + abilityScore.getAbilityScoreBonusValue(AbilityScore.CHARISMA));
        //Find a better way rather than remaking the list every time
        dialogAbilityScoreBonusDescriptions.setModel(player.getEffectManager().getDefaultListModel(EffectTarget.ABILITY_SCORE));
    }

    @Override
    public AbilityScorePanel getParent() {
        return parent;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton dialogAbilityScoreBonusAddModifier;
    private javax.swing.JLabel dialogAbilityScoreBonusCharisma;
    private javax.swing.JLabel dialogAbilityScoreBonusConstitution;
    private javax.swing.JList dialogAbilityScoreBonusDescriptions;
    private javax.swing.JLabel dialogAbilityScoreBonusDexterity;
    private javax.swing.JLabel dialogAbilityScoreBonusIntelligence;
    private javax.swing.JButton dialogAbilityScoreBonusRemoveModifier;
    private javax.swing.JLabel dialogAbilityScoreBonusStrength;
    private javax.swing.JLabel dialogAbilityScoreBonusWisdom;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel44;
    private javax.swing.JLabel jLabel45;
    private javax.swing.JLabel jLabel47;
    private javax.swing.JLabel jLabel61;
    private javax.swing.JLabel jLabel65;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane5;
    // End of variables declaration//GEN-END:variables
}
